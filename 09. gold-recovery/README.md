# Восстановление золота из руды
## Задача
Предсказать коэффициент восстановления золота из золотосодержащей руды
## Описание проекта
Строится модель машинного обучения для промышленной компании, разрабатывающей решения для эффективной работы промышленных предприятий. Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды на основе данных с параметрами добычи и очистки. Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

Для решения задачи вводится метрика качества **sMAPE** (англ. Symmetric Mean Absolute Percentage Error, «симметричное среднее абсолютное процентное отклонение»), которая рассчитывается по формуле

$$sMAPE = \frac{1}{N} \sum^{n}_{i=1}\frac{|y_i-\hat{y_i}|}{(|y_i|+|\hat{y_i}|)/2} * 100\%\ $$
где
* ${y_i}$ – значение целевого признака для объекта с порядковым номером i в выборке, на которой измеряется качество.
* $\hat{y_i}$ – значение предсказания для объекта с порядковым номером i, например, в тестовой выборке.
* *N* – Количество объектов в выборке.
* $ \sum^{n}_{i=1}\$ – cуммирование по всем объектам выборки (i меняется от 1 до N).
## Этапы работы:
* подготовка данных:
	* загрузка, обзор и выявление проблем в данных;
	* проверка правильности расчета эффективности обогащения;
	* анализ признаков, недоступных в тестовой выборке;
	* предобработка данных (добавление в тестовые данные целевых признаков, из обучающей выборки удалены признаки, недоступные в тестовой выборке, устранены пропуски во всех всех выборках)
* исследовательский анализ данных:
	* анализ изменения концентрации металлов на разных этапах очистки;
	* сравнение распределения размеров гранул на обучающей и тестовой выборках;
	* исследование концентрации всех веществ на разных стадиях;
* построение модели:
	* написание функции итоговой sMAPE
	* обучение разных моделей и оценка качества на кросс-валидации;
	* выбор лучшей модели и оценка ее качества на тестовой выборке
## Вывод 
Наилучший результат на кросс-валидации показывала модель дерева решений с с `max_depth = 3`, `min_samples_leaf=3`, которая показывает на тестовой выборке значение sMAPE несколько лучше, чем константная модель.
## Используемые библиотеки
*Pandas*, *NumPy*, *Matplotlib*, *Seaborn*, *Scikit-learn*
